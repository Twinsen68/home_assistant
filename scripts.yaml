#Manual Backup Button
backup:
  alias: Backup HA Configuration Files
  sequence:
    - service: shell_command.backup_configuration

#Manual Reefcam Restart Button
reefcam_restart:
  alias: Reefcam Restart
  sequence:
    - service: shell_command.reefcam_restart

#Manual ReefControlPi Restart Button
reef_control_restart:
  alias: Reef Control Pi Restart
  sequence:
    - service: shell_command.reefcontrolpi_reboot

#Manual Octocam Restart Button
#octocam_restart:
#  alias: Octocam Restart
#  sequence:
#    - service: shell_command.octocam_restart

#Manual Home Assistant Restart Button
ha_restart:
  alias: Home Assistant Restart
  sequence:
    - service: shell_command.ha_reboot

#Reef Tank Kessil Morning and Evening Light Fades
reeftank_morning_fade_kessil:  
  alias: "Reef Light Morning Fade Kessil"
  sequence:
    - delay:
        seconds: 7200
    - service: input_boolean.turn_off
      data:
        entity_id: input_boolean.reef_temp_nightime_state
    - service: input_boolean.turn_on
      data:
        entity_id: input_boolean.reef_temp_daytime_state
    - service: automation.trigger
      entity_id: automation.set_reef_thermostat_max_daytime_selector
    - service: switch.turn_on
      entity_id: switch.06200940dc4f22cbb432_2
    - service: automation.trigger
      entity_id: automation.set_reef_thermostat_max_daytime_selector
    - service: switch.turn_on
      entity_id: switch.06200940dc4f22cbb94b_4
    - delay:
        seconds: 480
    - service: homeassistant.turn_on
      entity_id: switch.kessil_light_level_1
    - delay:
        seconds: 1800
    - service: homeassistant.turn_on
      entity_id: switch.kessil_light_level_2
    - delay:
        seconds: 900
    - service: homeassistant.turn_on
      entity_id: switch.kessil_light_level_3
    - delay:
        seconds: 900
    - service: remote.send_command
      data_template:
        entity_id: remote.gabes_harmony_hub
        device: 43857787
        command: ['PowerToggle','2']
    - service: homeassistant.turn_on
      entity_id: switch.kessil_light_level_4
    - service: remote.send_command
      data_template:
        entity_id: remote.gabes_harmony_hub
        device: 43857787
        command: 'FastForward'
    - delay:
        seconds: 900
    - service: homeassistant.turn_on
      entity_id: switch.kessil_light_level_5
    - service: remote.send_command
      data_template:
        entity_id: remote.gabes_harmony_hub
        device: 43857787
        command: 'FastForward'
    - delay:
        seconds: 5200
    - service: homeassistant.turn_on
      entity_id: switch.kessil_light_level_6
    - service: remote.send_command
      data_template:
        entity_id: remote.gabes_harmony_hub
        device: 43857787
        command: 'FastForward'
    - delay:
        seconds: 12600
    - service: homeassistant.turn_on
      entity_id: switch.kessil_light_level_7
    - delay:
        seconds: 10800
    - service: homeassistant.turn_on
      entity_id: switch.kessil_light_level_8
    - delay:
        seconds: 3600
    - service: remote.send_command
      data_template:
        entity_id: remote.gabes_harmony_hub
        device: 43857787
        command: 'Rewind'
    - service: homeassistant.turn_on
      entity_id: switch.kessil_light_level_9
    - delay:
        seconds: 3600
    - service: remote.send_command
      data_template:
        entity_id: remote.gabes_harmony_hub
        device: 43857787
        command: 'Rewind'
    - service: homeassistant.turn_on
      entity_id: switch.kessil_light_level_10
    - service: remote.send_command
      data_template:
        entity_id: remote.gabes_harmony_hub
        device: 43857787
        command: 'Rewind'
    - delay:
        seconds: 3600
    - service: homeassistant.turn_on
      entity_id: switch.kessil_light_level_11
    - delay:
        seconds: 3600
    - service: homeassistant.turn_on
      entity_id: switch.kessil_light_level_12

reeftank_evening_fade_kessil:  
  alias: "Reef Light Evening Fade Kessil"
  sequence:
    - delay:
        seconds: 3600
    - service: remote.send_command
      data_template:
        entity_id: remote.gabes_harmony_hub
        device: 43857787
        command: 'Stop'
    - delay:
        seconds: 3600
    - service: input_boolean.turn_off
      data:
        entity_id: input_boolean.reef_temp_daytime_state
    - service: input_boolean.turn_on
      data:
        entity_id: input_boolean.reef_temp_nightime_state
    - service: automation.trigger
      entity_id: automation.set_reef_thermostat_max_nighttime_selector
    - service: homeassistant.turn_off
      entity_id: switch.kessil_light_level_12
    - delay:
        seconds: 480
    - service: switch.turn_off
      entity_id: switch.06200940dc4f22cbb94b_4

reeftank_sump_pulse:  
  alias: "Reef Tank Sump Pulse"
  sequence:
    - service: homeassistant.turn_on
      entity_id: switch.2437254184f3eb695276
    - delay:
        seconds: 90
    - service: homeassistant.turn_off
      entity_id: switch.2437254184f3eb695276


octotank_morning_on:
  alias: "Octo Light Morning On"
  sequence:
    - delay:
        seconds: 3600
    - service: switch.turn_on
      entity_id: switch.06200940dc4f22cbb432_4
#    - service: switch.turn_on
#      entity_id: switch.06200940dc4f22cbb432_3
    - service: automation.trigger
      entity_id: automation.set_amazon_thermostat_max_daytime_selector

octotank_evening_off:
  alias: "Octo Light Evening Off"
  sequence:
    - delay:
        seconds: 3600
    - service: switch.turn_off
      entity_id: switch.06200940dc4f22cbb432_4
#    - service: switch.turn_off
#      entity_id: switch.06200940dc4f22cbb432_3
    - service: automation.trigger
      entity_id: automation.set_amazon_thermostat_max_night_selector

#Vacuum Room
roomba_turn_on:  
  alias: "Turn On Roomba"
  sequence:
    - service: remote.send_command
      data_template:
        entity_id: remote.gabes_harmony_hub
        device: 55925028
        command: 'Medium'

#Freshwater Feeder
freshwater_feeder_script:  
  alias: "Feed the Fish"
  sequence:
    - service: switch.turn_on
      entity_id: switch.octofishfeeder
    - service: downloader.download_file
      data_template:
        url: "http://octocam.local:8765/picture/1/current/?_username=admin&_signature=a96455e6bfe50190508c4b21bc26d8f2ef93221d"
        filename: "latest_octocam.jpg"
        overwrite: true
    - delay:
        seconds: 240
    - service: switch.turn_off
      entity_id: switch.octofishfeeder
    - service: notify.octo_cam_bot_notifier
      data:
        message: "I, OctoCamBot, just fed the fish! \U0001F420 \U0001F95E \U0001F389 \U0001F32E \U0001F420 \U0001F9C1 \U0001F355 EmojiStats: \U0001F321 {{ states.sensor.mqtt_topic_octo_sysinfo_template_watertemp.state }}F \U0001F964  {{ states.sensor.mqtt_topic_octo_water_level_template_level.state }} \U0001F305 {{ states.sensor.amazonsunrisetides.state }} \U0001F307 {{ states.sensor.amazonsunsettides.state }}"
        data:
          media: /home/homeassistant/.homeassistant/www/images/latest_octocam.jpg

#Freshwater Waves
freshwater_waves_on_script:  
  alias: "Turn On Freshwater Waves"
  sequence:
    - service: switch.turn_on
      entity_id: switch.06200940dc4f22cbb432_1
    - delay:
        seconds: 6300
    - service: switch.turn_off
      entity_id: switch.06200940dc4f22cbb432_1
    - delay:
        seconds: 14400
    - service: switch.turn_on
      entity_id: switch.06200940dc4f22cbb432_1
    - delay:
        seconds: 6300
    - service: switch.turn_off
      entity_id: switch.06200940dc4f22cbb432_1

#Reef Waves
reef_waves_lowtide_fade_script:  
  alias: "Low Tide Reef Waves Fade"
  sequence:
    - service: switch.turn_off
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 360
    - service: switch.turn_on
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 980
    - service: switch.turn_off
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 2100
    - service: switch.turn_on
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 2905
    - service: switch.turn_off
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 3465
    - service: switch.turn_on
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 3885
    - service: switch.turn_off
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 4095
    - service: switch.turn_on
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 4200
    - service: switch.turn_off
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 4095
    - service: switch.turn_on
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 3885
    - service: switch.turn_off
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 3465
    - service: switch.turn_on
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 2905
    - service: switch.turn_off
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 2100
    - service: switch.turn_on
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 980
    - service: switch.turn_off
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 360
    - service: switch.turn_on
      entity_id: switch.06200940dc4f22cbb94b_2
    - delay:
        seconds: 230
    - service: switch.turn_off
      entity_id: switch.06200940dc4f22cbb94b_2

# Lovelace Theme Notification Text Clear
clear_notification_text:
  sequence:
    - service: input_text.set_value
      data_template:
        entity_id: input_text.notification_text
        value: "No Message"

# Alarm Clock
alarm_clock_loop:
  alias: Alarm Clock Loop
  sequence:
  - service: homeassistant.turn_on
    data:
      entity_id: group.all_lights

#Alarm 2
bedroom_wake_up:
  sequence:
    - service_template: >
        {% if is_state('sensor.dark_sky_icon' , 'rain') %} script.early_wakeup
        {% elif is_state('sensor.dark_sky_icon' , 'snow') %} script.early_wakeup
        {% else %} script.on_time_wakeup {% endif %}

early_wakeup:
  sequence:
    - service: script.notify
      data:
        message: "I am triggering the alarm fifteen minutes early because of bad weather"
    - service_template: >
        {% if is_state('input_boolean.bedroom_alarm_clock_repeat' , 'on') %} homeassistant.turn_on
        {% else %} homeassistant.turn_off {% endif %}
      entity_id: input_boolean.bedroom_alarm_clock_status
    - service: script.turn_on
      data:
        entity_id: sunrise_lights
    - delay: 00:45:00
    - service: rest_command.kiosk_sound_morning_birds
    - delay: 01:15:00
    - service: rest_command.kiosk_sound_morning_birds

on_time_wakeup:
  sequence:
    - delay: 00:15:00
    - service_template: >
        {% if is_state('input_boolean.bedroom_alarm_clock_repeat' , 'on') %} homeassistant.turn_on
        {% else %} homeassistant.turn_off {% endif %}
      entity_id: input_boolean.bedroom_alarm_clock_status
    - service: script.turn_on
      data:
        entity_id: sunrise_lights
    - delay: 00:45:00
    - service: rest_command.kiosk_sound_morning_birds
    - delay: 01:15:00
    - service: rest_command.kiosk_sound_morning_birds

#Sunrise lights
sunrise_lights:
  sequence:
    # light 1 dark red to medium warm orange
    - service: homeassistant.turn_on
      data:
        entity_id: light.bedside_table
        rgb_color: [98,19,0]
        brightness: 1
    - delay:
        seconds: 1.00
    - service: homeassistant.turn_on
      data:
        entity_id: light.bedside_table
        rgb_color: [249,123,0]
        brightness: 103
        transition: 15
    - delay:
        seconds: 15.00
    # light 2 dark warm orange to medium warm orange
    - service: homeassistant.turn_on
      data:
        entity_id: light.bedroom_desk
        rgb_color: [249,123,0]
        brightness: 1
    - delay:
        seconds: 1.00
    - service: homeassistant.turn_on
      data:
        entity_id: light.bedroom_desk
        rgb_color: [249,123,0]
        brightness: 103
        transition: 15
    - delay:
        seconds: 15.00
    # group medium warm orange to full bright
    - service: homeassistant.turn_on
      data:
        entity_id: light.bedroom
        rgb_color: [255,178,67]
        brightness: 255
        transition: 30
    # turn on hall light
    - service: switch.turn_on
      entity_id: switch.entry_light

usps_sms_notification:
  sequence:
    - service: ifttt.trigger
      data_template: {"event":"usps_mail_alert_1", "value1":"{{ sensor.usps_mail }}", "value2":"{{ sensor.usps_packages }}"}
    - service: ifttt.trigger
      data_template: {"event":"usps_mail_alert_2", "value1":"{{ sensor.usps_mail }}", "value2":"{{ sensor.usps_packages }}"}
    - service: automation.turn_off
      entity_id: automation.usps_mail_alert

kiosk_screen_value:
  sequence:
    - service: input_number.set_value
      data_template:
        entity_id: input_number.kiosk_brightness
        value: "{{ brightness }}"
    - service: rest_command.kiosk_screen_value

kiosk_weather_report:
  sequence:
    - service: notify.kiosk
      data:
        message: "Outside the temperature is, {{ states('sensor.dark_sky_temperature') }} degrees faren height, inside the temperature is, {{ states('sensor.mqtt_topic_garden_temperature_template') }} degrees faren height. You can expect {{ states('sensor.dark_sky_daily_summary') }}"

kiosk_good_morning:
  sequence:
    - service: rest_command.kiosk_sound_incomingtransmission
    - delay:
        seconds: 3.00
    - service: notify.kiosk
      data:
        message: "Good morning Gabe! The time is now, {{ states('sensor.time') }}. Outside the temperature is, {{ states('sensor.dark_sky_temperature') }} degrees fahrenheit and {{ states('sensor.dark_sky_minutely_summary') }}. You can expect {{ states('sensor.dark_sky_daily_summary') }}"
    - delay:
        seconds: 25.00
    - service: rest_command.kiosk_sound_spoken
    - service: rest_command.kiosk_sound_startrek_computer2
    - delay:
        seconds: 20.00
    - condition: template
      value_template: "{{ ((as_timestamp(states.calendar.gabethisisgabescom.attributes.start_time) - as_timestamp(now())) < 43200) and ((as_timestamp(states.calendar.gabethisisgabescom.attributes.start_time) - as_timestamp(now())) > 0) }}"
    - service: rest_command.kiosk_sound_startrek_computer1
    - service: notify.kiosk
      data:
        message: "By the way, on your calendar today is,  {{ states('calendar.gabethisisgabescom.attributes.message') }}, at {{ states('calendar.gabethisisgabescom.attributes.start_time') }}"
    - service: rest_command.kiosk_sound_startrek_computer2

fart_machine:
  sequence:
    - service: rest_command.kiosk_sound_fart1